<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8">

    <!--====== Title ======-->
    <title>Basic - SaaS Landing Page</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    {{!--
    <link rel="stylesheet" href="https://bootswatch.com/5/lux/bootstrap.min.css"> --}}
    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <!-- CUSTOM CSS -->
    {{!--
    <link rel="stylesheet" href="/css/main.css"> --}}

    <!--====== Favicon Icon ======-->
    <link rel="shortcut icon" href="/images/favicon.png" type="image/png">

    <!--====== Animate CSS ======-->
    <link rel="stylesheet" href="/css/animate.css">

    <!--====== Magnific Popup CSS ======-->
    <link rel="stylesheet" href="/css/magnific-popup.css">

    <!--====== Slick CSS ======-->
    <link rel="stylesheet" href="/css/slick.css">

    <!--====== Line Icons CSS ======-->
    <link rel="stylesheet" href="/css/LineIcons.css">

    <!--====== Font Awesome CSS ======-->
    <link rel="stylesheet" href="/css/font-awesome.min.css">

    <!--====== Bootstrap CSS ======-->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!--====== Default CSS ======-->
    <link rel="stylesheet" href="/css/default.css">

    <!--====== Style CSS ======-->
    <link rel="stylesheet" href="/css/style.css">

    <link rel="stylesheet" href="/fonts/icomoon/style.css">


    <style>
        .badge {
            display: inline-block;
            background-color: #e73939;
            color: white;
            padding: 5px 10px;
            border-radius: 50%;
        }

        .icon {
            font-size: 20px;
        }
    </style>


</head>

<body>
    <!--====== PRELOADER PART START ======-->
    <div class="preloader">
        <div class="loader">
            <div class="ytp-spinner">
                <div class="ytp-spinner-container">
                    <div class="ytp-spinner-rotator">
                        <div class="ytp-spinner-left">
                            <div class="ytp-spinner-circle"></div>
                        </div>
                        <div class="ytp-spinner-right">
                            <div class="ytp-spinner-circle"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <header class="header-area">
        <div class="navbar-area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <nav class="navbar navbar-expand-lg">
                            <a class="navbar-brand" href="/">
                                <img src="/images/logoinicio.png" alt="Logo">
                            </a>
                            <button class="navbar-toggler" type="button" data-toggle="collapse"
                                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                                aria-expanded="false" aria-label="Toggle navigation">
                                <span class="toggler-icon"></span>
                                <span class="toggler-icon"></span>
                                <span class="toggler-icon"></span>
                            </button>

                            <div class="collapse navbar-collapse sub-menu-bar" id="navbarSupportedContent">
                                <ul id="nav" class="navbar-nav ml-auto">
                                    <li class="nav-item active">
                                        <a class="page-scroll" href="/">Inicio</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="page-scroll" href="#features">Promociones</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="page-scroll" href="/articulos/articulosListado">Catalogo</a>
                                    </li>
                                    {{!-- <li class="nav-item">
                                        <a class="page-scroll" href="#facts">Nosotros</a>
                                    </li> --}}
                                    {{!-- <li class="nav-item">
                                        <a class="page-scroll" href="#team">Team</a>
                                    </li> --}}
                                    {{!-- <li class="nav-item">
                                        <a class="page-scroll" href="#blog">Blog</a>
                                    </li> --}}
                                </ul>
                            </div>
                            {{!-- <div class="navbar-btn d-none d-sm-inline-block">
                                <a class="main-btn" data-scroll-nav="0" href="#pricing">Free Trial</a>
                            </div> --}}
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <div id="home" class="header-hero bg_cover" style="background-image: url(/images/bannerfondo.jpg">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="header-hero-image text-center wow fadeIn" data-wow-duration="1.3s"
                            data-wow-delay="1.4s">
                            <h3 class="header-title wow fadeInUp" data-wow-duration="1.3s" data-wow-delay="0.5s"
                                style="padding-top:70px"></h3>
                        </div>
                    </div>
                </div>
            </div>
            <div id="particles-1" class="particles"></div>
        </div>

    </header>



    {{!-- FILTROS --}}

    <div class="container pt-70">
        <div class="row justify-content-center">
            <div class="col-lg-5">
                <div class="section-title text-center pt-70 pb-30">
                    <div class="line m-auto"></div>
                </div>
            </div>
        </div>
    </div>


    <hr>

    <div class="container">
        <div class="counter-wrapper mt-50 wow fadeIn" data-wow-duration="1s" data-wow-delay="0.8s">
            <div class="section-title">
                <h3 class="title">
                    <span>Carrito: </span>
                </h3>

                <div id="contador"></div>

                <hr>
                <div id="carrito"></div>
            </div>
            <div class="section-title pt-15">
                <a class="main-btn page-scroll" onclick="VaciarCarrito()" href="#" id="">VACIAR</a>
            </div>
        </div>
    </div>

    <hr>


    <div class="site-navbar pt-10">
        <div class="site-navigation text-right text-md-center" role="navigation">
            <div class="container">
                <ul class="site-menu js-clone-nav d-md-block">
                    <li class="has-children active">
                        <a>Articulos</a>
                        <ul class="dropdown">
                            <li><a href="/articulos/articulosListado?familia=all">Todos</a></li>
                            <li><a href="/articulos/articulosListado?familia=AER">Aerosoles</a></li>
                            {{!-- <li><a href="/articulos/articulosListado?familia=BAZAR">Bazar</a></li> --}}
                            <li><a href="/articulos/articulosListado?familia=ESPONJA">Esponjas</a></li>
                            <li><a href="/articulos/articulosListado?familia=PEG">Pegamentos</a></li>
                            <li><a href="/articulos/articulosListado?familia=CEP">Cepillos</a></li>
                            <li><a href="/articulos/articulosListado?familia=BOLSAS">Bolsas</a></li>
                            {{!-- <li><a href="#">Guantes</a></li> --}}
                            {{!-- <li><a href="#">Pastillas</a></li> --}}
                            <li><a href="/articulos/articulosListado?familia=PEG">Secadores</a></li>
                            <li class="has-children">
                                <a href="/articulos/articulosListado?familia=TRAPO">Trapos</a>
                                <ul class="dropdown">
                                    <li><a href="#">Rejillas</a></li>
                                    <li><a href="/articulos/articulosListado?familia=TRAPO">Trapos</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    {{!-- <li class="has-children">
                        <a href="#">Liquidos</a>
                        <ul class="dropdown">
                            <li><a href="#">Jabones de piso</a></li>
                            <li><a href="#">Suavizantes</a></li>
                            <li><a href="#">Cloro</a></li>
                            <li><a href="#">Lavandina</a></li>
                            <li><a href="#">Desinfectantes</a></li>
                        </ul>
                    </li> --}}
                    <li class="has-children">
                        <a href="/articulos/articulosListado?familia=PERF">Perfumeria</a>
                        <ul class="dropdown">
                            <li><a href="/articulos/articulosListado?familia=SAUME">Saumerios</a></li>
                            <li><a href="/articulos/articulosListado?familia=AROM">Aromatizantes</a></li>
                        </ul>
                    </li>
                    {{!-- <li><a href="/articulos/articulosListado?familia=TRAPO">Plasticos</a></li> --}}
                    <li><a href="/articulos/articulosListado?familia=MASCOTA">Mascotas</a></li>
                    {{!-- <li><a href="/articulos/articulosListado?familia=PLAST">Descartables</a></li> --}}
                    <li><a href="/articulos/articulosListado?familia=VEN">Venenos</a></li>
                </ul>
            </div>
        </div>
    </div>

    {{!-- fin FILTROS --}}


    <section id="team" class="team-area pt-70 pb-100">
        <div class="container">
            {{!-- <div class="row justify-content-center">
                <div class="col-lg-5">
                    <div class="section-title text-center pt-70 pb-30">
                        <div class="line m-auto"></div>
                    </div>
                </div>
            </div> --}}
            <div class="row justify-content-center">
                {{#each articulos}}
                <div class="col-lg-3 col-md-7 col-sm-8" style="">
                    <div class="single-team text-center mt-30 wow fadeIn" data-wow-duration="1s" data-wow-delay="0.2s">
                        <div class="team-image">
                            <img src="/images/team-1.png" alt="Team">
                        </div>
                        <div class="team-content">
                            <p class="text">{{descripcion}}</p>


                            <div class="text-center p-3">
                                {{!-- <a class="main-btn" data-scroll-nav="0" href="/articulos/articulosListado/">+</a>
                                --}}
                                <div style="display: flex; justify-content: center;">
                                    <button class="main-btn" style="background: #e73939; margin-right: 5px;"
                                        onclick="agregarAlCarrito('{{_id}}', '{{descripcion}}')">+</button>
                                    <button class="main-btn" style="background: #e73939; margin-left: 5px;"
                                        onclick="quitarDelCarrito('{{_id}}')">-</button>
                                </div>
                            </div>
                            <h5 class="holder-name pt-2"><a href="">${{precio}}</a></h5>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>

            {{!-- <div class="text-center p-5">
                <a class="main-btn" data-scroll-nav="0" href="/articulos/articulosListado?familia=all">VER MAS</a>
            </div> --}}

        </div>
    </section>

    <!--====== BLOG PART ENDS ======-->

    <!--====== FOOTER PART START ======-->

    <footer id="footer" class="footer-area pt-120">
        <div class="container">
            <div class="subscribe-area wow fadeIn" data-wow-duration="1s" data-wow-delay="0.5s">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="subscribe-content mt-45">
                            <h2 class="subscribe-title"><span>Contacto</span></h2>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="subscribe-form mt-50">
                            <form action="#">
                                <input type="text" placeholder="Ingrese un mail">
                                <button class="main-btn" style="background: #e73939">Enviar</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-copyright">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="copyright d-sm-flex justify-content-between">
                            <div class="copyright-content">
                                <p class="text">Designed and Developed by <a href="https://uideck.com"
                                        rel="nofollow">Belthier</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="particles-2"></div>
    </footer>

    <!--====== FOOTER PART ENDS ======-->










    <!--====== CARRITO ======-->

    {{!-- <a href="/articulos/carritocompras?carrito=JSON.parse({{cartcompras}})" class="cart-details mb-5"><i
            class="lni lni-cart"></i></a> --}}

    {{!-- <button class="cart-details mb-5" onclick="enviarCarrito()"><i class="lni lni-cart"></i></button> --}}

    <form id="cartForm" method="POST" action="/articulos/enviocarritovista">
        <input type="hidden" id="cartcompras" name="cartcompras" value="" />
        <button type="button" class="cart-details mb-5" id="cartButton"><i class="lni lni-cart"></i></button>
    </form>





    <!--====== BACK TOP TOP PART START ======-->

    <a href="#" class="back-to-top"><i class="lni-chevron-up"></i></a>




    <!-- Scritps -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>

    {{!-- scrikpts --}}

    <script src="/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="/js/vendor/modernizr-3.7.1.min.js"></script>

    <!--====== Bootstrap js ======-->
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>

    <!--====== Plugins js ======-->
    <script src="/js/plugins.js"></script>

    <!--====== Slick js ======-->
    <script src="/js/slick.min.js"></script>

    <!--====== Ajax Contact js ======-->
    <script src="/js/ajax-contact.js"></script>

    <!--====== Counter Up js ======-->
    <script src="/js/waypoints.min.js"></script>
    <script src="/js/jquery.counterup.min.js"></script>

    <!--====== Magnific Popup js ======-->
    <script src="/js/jquery.magnific-popup.min.js"></script>

    <!--====== Scrolling Nav js ======-->
    <script src="/js/jquery.easing.min.js"></script>
    <script src="/js/scrolling-nav.js"></script>

    <!--====== wow js ======-->
    <script src="/js/wow.min.js"></script>

    <!--====== Particles js ======-->
    <script src="/js/particles.min.js"></script>

    <!--====== Main js ======-->
    <script src="/js/main.js"></script>


    <!--====== scripts solo de listado articulos ======-->
    <script>

        let carrito = [];
        //boton carrito
        $('.cart-details').fadeIn(100);

        const carro = {{{ json carritoDeCompras }}};
        console.log('carro');
        console.log(carro);

        carrito = Array.isArray(carro) ? carro : [];

        // Función para agregar un producto al carrito
        function agregarAlCarrito(_id, descripcion) {
            const index = carrito.findIndex(item => item._id === _id);

            if (index === -1) {
                carrito.push({ _id, descripcion, cantidad: 1 });
            } else {
                carrito[index].cantidad++;
            }

            actualizarCarrito();
        }

        // Función para quitar un producto del carrito
        function quitarDelCarrito(_id) {
            const index = carrito.findIndex(item => item._id === _id);

            if (index !== -1) {
                if (carrito[index].cantidad > 1) {
                    carrito[index].cantidad--;
                } else {
                    carrito.splice(index, 1);
                }

                actualizarCarrito();
            }
        }

        // Función para actualizar la vista del carrito en el HTML
        function actualizarCarrito() {
            const carritoElement = document.getElementById('carrito');
            const contadorElement = document.getElementById('contador');

            const productosUnicos = Object.keys(carrito).length;
            let totalCantidad = 0;
            carritoElement.innerHTML = '';

            //cartcompras=carrito;//Object.keys(carrito);
            for (const id in carrito) {
                const producto = carrito[id];
                carritoElement.innerHTML += `<p>Producto: ${producto.descripcion}, Cantidad: ${producto.cantidad}</p>`;
                //totalCantidad += producto.cantidad;
            }
            //cuento la cant de articulos y la muestro en el div con id contador
            contadorElement.textContent = productosUnicos;
            console.log('Carrito actualizado:', carrito);
            updateCart(carrito);
        }



        // se ejecuta al iniciar la pagina
        document.addEventListener("DOMContentLoaded", function () {
            const cartcomprasInput = document.getElementById("cartcompras");
            const cartButton = document.getElementById("cartButton");

            actualizarCarrito();

            // Agrega un evento al botón para enviar el formulario cuando se haga clic
            cartButton.addEventListener("click", function () {
                const cartcomprasData = carrito;
                cartcomprasInput.value = JSON.stringify({ cartcomprasData });
                // Envía el formulario
                document.getElementById("cartForm").submit();
            });
        });



        // PARA QUE SE ACTUALICE EL CARRITO CUANDO PONGO UN FILTRO, DEBO ACTUALIZAR LA VARIABLE DE SESSION AL ACTUALIZAR EL CARRO
        function updateCart(cart) {
            console.log('Carrito actualizado cart update', cart);
            fetch('/update-cart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ carrito: cart })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        console.log('Carrito actualizadocarroskicarroski:', data.carroski);
                    } else {
                        console.error('Error al actualizar el carroski');
                    }
                });
        }



        function VaciarCarrito(cart) {
            carrito = [];
            actualizarCarrito();
        }

    </script>

</body>

</html>